# mongo-dao-generator

##### [中文文档](README-zh.md)

### 1.Introduction

mongo-dao-generator is a tool for automatically generating MongoDB Data Access Object.

### 2.Advantage

* Supports automatic filling of primitive.ObjectID and primitive.DateTime types.

* Supports automatic increment of int, int8, int16, int32, int64, uint, uint8, uint16, uint32 and uint64 types.

* Provides a unified generation scheme for database fields, avoiding the problem of database fields that can be seen everywhere in business codes.

* Provides various database operation interfaces including InsertOne, InsertMany, UpdateOne, UpdateOneByID, UpdateMany, FindOne, FindOneByID, FindMany, DeleteOne, DeleteOneByID, DeleteMany, Count, Aggregate, etc.

* Provides the ability to expand the database operation interface.

* Provides two package solutions: subcontracting and non-subcontracting.

* Supports customization of directory and file name styles.

### 3.Download and install

```shell
go intall github.com/dobyte/mongo-dao-generator
```

### 4.Usage

```shell
Usage of mongo-dao-generator:
    mongo-dao-generator [flags] -model-dir=. -model-names=T,T -dao-dir=./dao
For more information, see:
    https://github.com/dobyte/mongo-dao-generator
Flags:
  -counter-name string
        specify the counter name; default is counter
  -dao-dir string
        specify the output directory of dao files; must be set
  -dao-pkg-path string
        specify the package path corresponding to the output directory of the dao files; automatically generated by default
  -file-style string
        specify the generation style for file; options: kebab | underscore | lower | camel | pascal; default is underscore (default "underscore")
  -model-dir string
        specify the model directory; must be set
  -model-names string
        specify the comma-separated list of model name; must be set
  -model-pkg-alias string
        specify a model package alias; default no alias
  -model-pkg-path string
        specify the package path corresponding to the model directory; automatically calculated by default
  -subpkg-enable
        specify whether to enable subpkg; default disable
  -subpkg-style string
        specify the generation style for subpkg; options: kebab | underscore | lower | camel | pascal; default is kebab (default "kebab")
```

### 5.Extension tags

The parsing of gen tags is supported in the model definition, and the following tag parsing is currently supported:

| Tag Name |                                                            | Example            | Description                                                                                         |
| -------- | ---------------------------------------------------------- | ------------------ | --------------------------------------------------------------------------------------------------- |
| autoFill | primitive.ObjectID、primitive.DateTime                      | gen:"autoFill"     |                                                                                                     |
| autoIncr | int、int8、int16、int32、int64、uint、uint8、uint16、uint32、uint64 | gen:"autoIncr:uid" | The increment is atomic and the counter code is generated synchronously when the code is generated. |

### 6.Example

###### 6-1.Create model

model/mail.go

```go
package model

import "go.mongodb.org/mongo-driver/bson/primitive"

//go:generate mongo-dao-generator -model-dir=. -model-names=Mail -dao-dir=../dao/
type Mail struct {
    ID       primitive.ObjectID `bson:"_id" gen:"autoFill"`       // mail id
    Title    string             `bson:"title"`                    // mail title
    Content  string             `bson:"content"`                  // mail content
    Sender   int64              `bson:"sender"`                   // sender's uid
    Receiver int64              `bson:"receiver"`                 // receiver's uid
    Status   int                `bson:"status"`                   // mail status
    SendTime primitive.DateTime `bson:"send_time" gen:"autoFill"` // send time
}
```

###### 6-2.Generate dao files

```bash
% go generate ./...
```
